<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>daadfaca-85aa-49ee-8abc-6c63472396c2</title><meta name="author" content="Devaj Sudhakar"/><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 h1 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 14pt; }
 p { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; margin:0pt; }
 .s1 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 14pt; }
 .s2 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 14pt; }
 li {display: block; }
 #l1 {padding-left: 0pt;counter-reset: c1 3; }
 #l1> li>*:first-child:before {counter-increment: c1; content: counter(c1, decimal)". "; color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 13pt; }
 #l1> li:first-child>*:first-child:before {counter-increment: c1 0;  }
 #l2 {padding-left: 0pt;counter-reset: d1 1; }
 #l2> li>*:first-child:before {counter-increment: d1; content: counter(d1, decimal)". "; color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l2> li:first-child>*:first-child:before {counter-increment: d1 0;  }
</style></head><body><h1 style="padding-left: 5pt;text-indent: 0pt;text-align: left;">2 Develop a MapReduce program to implement Matrix Multiplication</h1><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">to create a mapper file nano mapper.py Pyhton Code-</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">#!/usr/bin/env python3 import sys</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"># Define matrix dimensions (should be adapted to actual input) A_ROWS = 2 # Number of rows in Matrix A</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">B_COLS = 2 # Number of columns in Matrix B</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 17pt;text-indent: -12pt;text-align: left;">for line in sys.stdin: line = line.strip()</p><p style="padding-left: 17pt;text-indent: 0pt;line-height: 17pt;text-align: left;">matrix, row, col, value = line.split()</p><p style="padding-left: 17pt;text-indent: 0pt;text-align: left;">row, col, value = int(row), int(col), int(value)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 17pt;text-indent: 0pt;line-height: 17pt;text-align: left;">if matrix == &quot;A&quot;:</p><p style="padding-left: 30pt;text-indent: 0pt;text-align: left;"># Emit for every column in B for k in range(B_COLS):</p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">print(f&quot;{row} {k}\tA {col} {value}&quot;)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 17pt;text-indent: 0pt;line-height: 17pt;text-align: left;">elif matrix == &quot;B&quot;:</p><p style="padding-left: 30pt;text-indent: 0pt;text-align: left;"># Emit for every row in A for i in range(A_ROWS):</p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">print(f&quot;{i} {col}\tB {row} {value}&quot;)</p><p style="padding-top: 17pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">to create a reducer file nano reducer.py Python Code-</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">import sys</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">from collections import defaultdict</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"># Dictionary to store intermediate values</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">intermediate = defaultdict(list)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 17pt;text-indent: -12pt;text-align: left;">for line in sys.stdin: line = line.strip()</p><p style="padding-left: 17pt;text-indent: 0pt;text-align: left;">key, value = line.split(&quot;\t&quot;) i, j = map(int, key.split()) parts = value.split()</p><p style="padding-left: 5pt;text-indent: 12pt;line-height: 34pt;text-align: left;">intermediate[(i, j)].append((parts[0], int(parts[1]), int(parts[2]))) # Compute final matrix multiplication</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">for (i, j), values in intermediate.items():</p><p style="padding-left: 17pt;text-indent: 0pt;text-align: left;">a_values = {k: v for m, k, v in values if m == &quot;A&quot;} b_values = {k: v for m, k, v in values if m == &quot;B&quot;}</p><p style="padding-top: 2pt;padding-left: 17pt;text-indent: 0pt;line-height: 34pt;text-align: left;">result = sum(a_values[k] * b_values[k] for k in a_values if k in b_values) if result:</p><p style="padding-left: 30pt;text-indent: 0pt;line-height: 14pt;text-align: left;">print(f&quot;{i} {j} {result}&quot;)</p><p style="padding-top: 17pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">to create input file nano matrix.txt</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">A 0 0 3</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">A 0 1 2</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">A 1 0 1</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">A 1 1 4</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">B 0 0 2</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">B 1 0 5</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">B 0 1 3</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">B 1 1 1</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Command to run the program</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 300%;text-align: left;">cat matrix.txt | python mapper.py | sort | python reducer.py output</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">0 0 16</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">0 1 11</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">1 0 22</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">1 1 7</p><p style="padding-top: 17pt;text-indent: 0pt;text-align: left;"><br/></p><ol id="l1"><li data-list-text="3."><h1 style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Develop a mapreduce program that mines weather data and displays appropriate messages including the weather condition of the day</h1><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">To create a file gedit weather.py</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Pyhton Code-</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 34pt;text-align: left;">from mrjob.job import MRJob class WeatherAnalysis(MRJob):</p><p style="padding-left: 17pt;text-indent: 0pt;line-height: 14pt;text-align: left;">def mapper(self, _, line):</p><p style="padding-left: 30pt;text-indent: 0pt;line-height: 17pt;text-align: left;">try:</p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">date, temp, humidity, precipitation = line.split(&#39;,&#39;) temp = float(temp)</p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">humidity = float(humidity)</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 17pt;text-align: left;">precipitation = float(precipitation)</p><p style="padding-left: 30pt;text-indent: 12pt;text-align: left;">yield date, (temp, humidity, precipitation) except ValueError:</p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">pass # Skip lines with errors</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 17pt;text-indent: 0pt;line-height: 17pt;text-align: left;">def reducer(self, date, values):</p><p style="padding-left: 30pt;text-indent: 0pt;line-height: 17pt;text-align: left;">total_temp, total_humidity, total_precipitation = 0, 0, 0</p><p style="padding-left: 30pt;text-indent: 0pt;text-align: left;">count = 0</p><p style="padding-top: 17pt;padding-left: 42pt;text-indent: -12pt;text-align: left;">for temp, humidity, precipitation in values: total_temp += temp</p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">total_humidity += humidity</p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">total_precipitation += precipitation count += 1</p><p style="padding-top: 17pt;padding-left: 30pt;text-indent: 0pt;text-align: left;">avg_temp = total_temp / count</p><p style="padding-left: 30pt;text-indent: 0pt;text-align: left;">avg_humidity = total_humidity / count avg_precipitation = total_precipitation / count</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 30pt;text-indent: 0pt;text-align: left;"># Determine weather condition if avg_temp &gt; 30:</p><p style="padding-left: 30pt;text-indent: 12pt;text-align: left;">condition = &quot;Hot Day&quot; elif avg_temp &lt; 10:</p><p style="padding-left: 30pt;text-indent: 12pt;text-align: right;">condition = &quot;Cold Day&quot; elif avg_precipitation &gt; 5: condition = &quot;Rainy Day&quot;</p><p style="padding-left: 42pt;text-indent: -12pt;text-align: left;">elif avg_humidity &gt; 80: condition = &quot;Humid Day&quot;</p><p style="padding-left: 30pt;text-indent: 0pt;text-align: left;">else:</p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">condition = &quot;Pleasant Day&quot;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 30pt;text-indent: 0pt;line-height: 17pt;text-align: left;">yield date, f&quot;{condition} - Avg Temp: {avg_temp:.1f}Â°C, Humidity:</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">{avg_humidity:.1f}%, Precipitation: {avg_precipitation:.1f}mm&quot;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 17pt;text-indent: -12pt;text-align: left;">if <span class="s1">&nbsp; </span>name<span class="s1">&nbsp; </span>== &quot;<span class="s1">&nbsp; </span>main<span class="s1">&nbsp; </span>&quot;: WeatherAnalysis.run()</p><p style="padding-top: 17pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">to create input file nano weather_data.csv</p><p style="padding-left: 5pt;text-indent: 12pt;text-align: left;">YYYY-MM-DD,temperature,humidity,precipitation 2025-03-07,32,60,1.2</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">2025-03-07,28,65,0.8</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">2025-03-07,35,55,0.5</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">2025-03-08,15,85,7.0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 199%;text-align: left;">Command to execute the program python weather.py weather_data.csv</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">output</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">&quot;2025-03-07&quot;   &quot;Hot Day - Avg Temp: 31.7\u00b0C, Humidity: 60.0%, Precipitation: 0.8mm&quot;</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">&quot;2025-03-08&quot;   &quot;Rainy Day - Avg Temp: 15.0\u00b0C, Humidity: 85.0%, Precipitation: 7.0mm&quot;</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="4."><h1 style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Develop a mapreduce program to find the tags associated with each movie by analyzing movie lens data.</h1><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">To create a file</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 199%;text-align: left;">gedit movie_tag_analysis.py Python Code-</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">from mrjob.job import MRJob</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 17pt;text-indent: -12pt;text-align: left;">class MovieTagAnalysis(MRJob): def mapper(self, _, line):</p><p style="padding-left: 30pt;text-indent: 0pt;line-height: 17pt;text-align: left;">try:</p><p style="padding-left: 42pt;text-indent: 0pt;text-align: justify;">movie_id, tag = line.split(&#39;,&#39;) movie_id = movie_id.strip() tag = tag.strip()</p><p style="padding-left: 30pt;text-indent: 12pt;text-align: left;">yield movie_id, tag except ValueError:</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 17pt;text-align: left;">pass # Skip lines with errors</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 30pt;text-indent: -12pt;text-align: left;">def reducer(self, movie_id, tags): yield movie_id, list(tags)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 17pt;text-indent: -12pt;text-align: left;">if <span class="s1">&nbsp; </span>name<span class="s1">&nbsp; </span>== &quot;<span class="s1">&nbsp; </span>main<span class="s1">&nbsp; </span>&quot;: MovieTagAnalysis.run()</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">To Create Input file</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 34pt;text-align: left;">nano movie_tags.csv 1,Action</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">1,Thriller 2,Comedy</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">2,Romance 3,Sci-Fi</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">3,Adventure 1,Drama</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Command to run the program</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">python movie_tag_analysis.py movie_tags.csv</p><p style="padding-top: 17pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Output</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;1&quot;  [&quot;Action&quot;,&quot;Thriller&quot;,&quot;Drama&quot;]</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;2&quot;  [&quot;Comedy&quot;,&quot;Romance&quot;]</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;3&quot;  [&quot;Sci-Fi&quot;,&quot;Adventure&quot;]</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-left: 5pt;text-indent: 0pt;text-align: left;">How to install apache pig</h1><p style="padding-top: 17pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Step 1: Download Apache Pig</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: justify;">wget https://downloads.apache.org/pig/latest/pig-0.17.0.tar.gz tar -xvzf pig-0.17.0.tar.gz</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: justify;">sudo mv pig-0.17.0 /usr/local/pig Step 2: Set Environment Variables nano ~/.bashrc</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">Add the following lines at the end:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">export PIG_HOME=/usr/local/pig</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">export PATH=$PIG_HOME/bin:$PATH</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">export PIG_CLASSPATH=$HADOOP_HOME/conf</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64 export PATH=$JAVA_HOME/bin:$PATH</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">Step 3: Apply Changes source ~/.bashrc</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">Step 4: Verify the Installation pig -version</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">You should see output like: Apache Pig version 0.17.0</p><p style="padding-top: 17pt;text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="5."><h1 style="padding-left: 18pt;text-indent: -13pt;text-align: left;">Implement Functions: Count, Sort, Limit, Skip, Aggregate using MongoDB</h1><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">Step 1: Start MongoDB shell mongosh</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">Step 2: Use (or create) the database use school</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">Step 3: Insert sample data into `students` collection</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">db.students.insertMany([</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 17pt;text-align: left;">{ name: &quot;Alice&quot;, age: 20, grade: 88 },</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 17pt;text-align: left;">{ name: &quot;Bob&quot;, age: 22, grade: 75 },</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 17pt;text-align: left;">{ name: &quot;Charlie&quot;, age: 23, grade: 85 },</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 17pt;text-align: left;">{ name: &quot;David&quot;, age: 21, grade: 95 },</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 17pt;text-align: left;">{ name: &quot;Eve&quot;, age: 20, grade: 78 },</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 17pt;text-align: left;">{ name: &quot;Frank&quot;, age: 25, grade: 82 }</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">])</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Step 4: Perform following operations</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l2"><li data-list-text="1."><p style="padding-left: 5pt;text-indent: 42pt;line-height: 200%;text-align: left;">Count all documents db.students.countDocuments({})</p></li><li data-list-text="2."><p style="padding-left: 65pt;text-indent: -17pt;text-align: left;">Sort students by grade (descending)</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">db.students.find().sort({ grade: -1 })</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="3."><p style="padding-left: 5pt;text-indent: 42pt;line-height: 200%;text-align: left;">Limit to top 3 students db.students.find().sort({ grade: -1 }).limit(3)</p></li><li data-list-text="4."><p style="padding-left: 5pt;text-indent: 42pt;line-height: 200%;text-align: left;">Skip the first 2 documents db.students.find().skip(2)</p></li><li data-list-text="5."><p style="padding-left: 65pt;text-indent: -17pt;line-height: 17pt;text-align: left;">Aggregate: Get average grade grouped by age</p></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">db.students.aggregate([</p><p style="padding-left: 11pt;text-indent: 0pt;text-align: left;">{</p><p style="padding-left: 17pt;text-indent: 0pt;line-height: 17pt;text-align: left;">$group: {</p><p style="padding-left: 23pt;text-indent: 0pt;line-height: 17pt;text-align: left;">_id: &quot;$age&quot;,</p><p style="padding-left: 23pt;text-indent: 0pt;line-height: 17pt;text-align: left;">averageGrade: { $avg: &quot;$grade&quot; }</p><p style="padding-left: 17pt;text-indent: 0pt;line-height: 17pt;text-align: left;">}</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 17pt;text-align: left;">},</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 17pt;text-align: left;">{</p><p style="padding-left: 17pt;text-indent: 0pt;line-height: 17pt;text-align: left;">$sort: { averageGrade: -1 }</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 17pt;text-align: left;">}</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">])</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="6."><h1 style="padding-left: 15pt;text-indent: -10pt;text-align: left;">Develop Pig Latin scripts to sort, group, join, project, and filter the data.</h1></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">Create a Pig script file nano script.pig</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">-- Load employee data</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">EMPLOYEES = LOAD &#39;employees.csv&#39; USING PigStorage(&#39;,&#39;)</p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 17pt;text-align: left;">AS (id:INT, name:CHARARRAY, age:INT, department:CHARARRAY, salary:DOUBLE);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">-- Load department data</p><p style="padding-left: 49pt;text-indent: -44pt;text-align: left;">DEPARTMENTS = LOAD &#39;departments.csv&#39; USING PigStorage(&#39;,&#39;) AS (dept_id:CHARARRAY, dept_name:CHARARRAY);</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">-- Filter employees with salary &gt; 50000</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">FILTERED_EMPLOYEES = FILTER EMPLOYEES BY salary &gt; 50000;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">-- Group by department</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">GROUPED_EMPLOYEES = GROUP FILTERED_EMPLOYEES BY department;</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">-- Join with department data</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">JOINED_DATA = JOIN FILTERED_EMPLOYEES BY department, DEPARTMENTS BY dept_id;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">-- Select required columns</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">PROJECTED_DATA = FOREACH JOINED_DATA GENERATE id, name, age, dept_name, salary;</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">-- Sort by salary descending</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SORTED_DATA = ORDER PROJECTED_DATA BY salary DESC;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">-- Store output</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">STORE SORTED_DATA INTO &#39;output&#39; USING PigStorage(&#39;,&#39;);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Prepare Input Data</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">To Create employees.csv nano employees.csv</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">1,Alice,30,IT,80000</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">2,Bob,35,HR,75000</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">3,Charlie,28,Finance,60000 4,David,40,IT,55000</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">5,Eve,45,HR,45000</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">6,Frank,50,Marketing,70000 7,Grace,29,Finance,48000</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">8,Hank,33,IT,52000</p><p style="padding-top: 17pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">To Create departments.csv</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">IT,Information Technology HR,Human Resources</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Finance,Finance Department</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Marketing,Marketing Team</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 199%;text-align: left;">Command to Run Pig Script pig -x local script.pig</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">ls output/</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: justify;">part-r-00000 _SUCCESS cat output/part-r-00000 Output</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">1,Alice,30,Information Technology,80000.0 2,Bob,35,Human Resources,75000.0</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">6,Frank,50,Marketing Team,70000.0</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">3,Charlie,28,Finance Department,60000.0 4,David,40,Information Technology,55000.0 8,Hank,33,Information Technology,52000.0</p><h1 style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">8.Implement a word count program in hadoop and spark</h1><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><u>word count program in Hadoop</u> To create a file</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">gedit worcount.py Python Code</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">from mrjob.job import MRJob import re</p><p style="padding-top: 16pt;padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">WORD_RE = re.compile(r&quot;\b\w+\b&quot;) class WordCountMR(MRJob):</p><p style="padding-left: 17pt;text-indent: 0pt;text-align: left;">def mapper(self, _, line):</p><p style="padding-left: 30pt;text-indent: 0pt;text-align: left;">&quot;&quot;&quot;Emit each word with a count of 1&quot;&quot;&quot; for word in WORD_RE.findall(line):</p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">yield word.lower(), 1</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 30pt;text-indent: -12pt;text-align: left;">def reducer(self, word, counts): &quot;&quot;&quot;Sum up counts for each word&quot;&quot;&quot; yield word, sum(counts)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 17pt;text-indent: -12pt;text-align: left;">if <span class="s1">&nbsp; </span>name<span class="s1">&nbsp; </span>== &quot;<span class="s1">&nbsp; </span>main<span class="s1">&nbsp; </span>&quot;: WordCountMR.run()</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">To create input file nano input.txt</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">hai how are you i m fine</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">hai how about you</p><p style="padding-top: 17pt;text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">To run the program</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">python wordcount.py input.txt output</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;about&quot; 1</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;are&quot; 1</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;fine&quot; 1</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;hai&quot; 2</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;how&quot;2</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;i&quot;  1</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;m&quot;  1</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">&quot;you&quot; 2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s2" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">word count program in spark</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">To create a file</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">gedit wordcountspark.py</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">from pyspark.sql import SparkSession</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">from pyspark.sql.functions import explode, split, col</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;"># Initialize Spark session</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">spark = SparkSession.builder.appName(&quot;WordCount&quot;).getOrCreate()</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;"># Read input text file</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">text_rdd = spark.read.text(&quot;input.txt&quot;).rdd</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"># Perform word count using RDD transformations word_counts = (</p><p style="padding-left: 17pt;text-indent: 0pt;line-height: 17pt;text-align: left;">text_rdd.flatMap(lambda line: line[0].split()) # Split lines into words</p><p style="padding-left: 17pt;text-indent: 0pt;line-height: 17pt;text-align: left;">.map(lambda word: (word.lower(), 1))    # Map each word to (word, 1)</p><p style="padding-left: 17pt;text-indent: 0pt;text-align: left;">.reduceByKey(lambda a, b: a + b)     # Reduce by key (word)</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"># Collect and print results</p><p style="padding-left: 17pt;text-indent: -12pt;text-align: left;">for word, count in word_counts.collect(): print(f&quot;{word}: {count}&quot;)</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"># Stop Spark session spark.stop()</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 200%;text-align: left;">To create input file nano input.txt</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">hai how are you i m fine</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">hai how about you</p><p style="padding-top: 17pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">To run the program</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">spark-submit wordcountspark.py output</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">hai: 2</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">how: 2</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">are: 1</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">you: 2</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">i: 1</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">m: 1</p></body></html>
